{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-3">Create Multiple Ornaments</h2>

    {% if formset.non_form_errors %}
        <div class="alert alert-danger">
            {{ formset.non_form_errors }}
        </div>
    {% endif %}

    <div class="card shadow-sm">
        <div class="card-body">
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                {{ formset.management_form }}

                <div class="table-responsive">
                    <table class="table table-bordered table-sm align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>#</th>
                                <th>Ornament Date</th>
                                <th>Type</th>
                                <th>Metal</th>
                                <th>Main Cat.</th>
                                <th>Sub Cat.</th>
                                <th>Name</th>
                                <th>Gross Wt</th>
                                <th>Metal Wt</th>
                                <th>Diamond Wt</th>
                                <th>Zircon Wt</th>
                                <th>Stone Wt</th>
                                <th>Stone Price / Ct</th>
                                <th>Stone Total</th>
                                <th>Jarti</th>
                                <th>Jyala</th>
                                <th>Kaligar</th>
                                <th>Image</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for form in formset %}
                                <tr>
                                    <td>{{ forloop.counter }}</td>

                                    {# Hidden id & code fields if present #}
                                    {% if form.id %}{{ form.id }}{% endif %}
                                    {% if form.code %}{{ form.code.as_hidden }}{% endif %}

                                    <td>
                                        {{ form.ornament_date }}
                                    </td>
                                    <td>
                                        {{ form.ornament_type }}
                                    </td>
                                    <td>
                                        {{ form.metal_type }}
                                    </td>
                                    <td>
                                        {{ form.maincategory }}
                                    </td>
                                    <td>
                                        {{ form.subcategory }}
                                    </td>
                                    <td>
                                        {{ form.ornament_name }}
                                    </td>
                                    <td>
                                        {{ form.gross_weight }}
                                    </td>
                                    <td>
                                        {{ form.weight }}
                                    </td>
                                    <td>
                                        {{ form.diamond_weight }}
                                    </td>
                                    <td>
                                        {{ form.zircon_weight }}
                                    </td>
                                    <td>
                                        {{ form.stone_weight }}
                                    </td>
                                    <td>
                                        {{ form.stone_percaratprice }}
                                    </td>
                                    <td>
                                        {{ form.stone_totalprice }}
                                    </td>
                                    <td>
                                        {{ form.jarti }}
                                    </td>
                                    <td>
                                        {{ form.jyala }}
                                    </td>
                                    <td>
                                        {{ form.kaligar }}
                                    </td>
                                    <td>
                                        {{ form.image }}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

                <div class="mt-3 d-flex justify-content-end gap-2">
                    <button type="submit" class="btn btn-success">Save Ornaments</button>
                    <a href="{% url 'ornament:list' %}" class="btn btn-secondary">Cancel</a>
                </div>
            </form>
        </div>
    </div>

    <p class="mt-2 text-muted small">
        Note: Leave unused rows empty; only filled rows will be saved.
    </p>
</div>
{% endblock %}
